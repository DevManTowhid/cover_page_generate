<script>
  document.addEventListener("DOMContentLoaded", () => {
    const reportTypes = ["Lab Report", "Project Report", "Assignment", "Internship", "Thesis"];
    const reportTypeSelect = document.getElementById('reportTypeSelect');
    reportTypes.forEach(type => {
      const option = document.createElement('option');
      option.value = type;
      option.textContent = type;
      reportTypeSelect.appendChild(option);
    });

    const previewContainer = document.createElement("div");
    previewContainer.className = "mt-8 p-6 bg-white shadow-lg rounded-lg w-full max-w-2xl mx-auto text-center font-serif space-y-4 hidden";
    document.body.appendChild(previewContainer);

    document.getElementById("generatePDF").addEventListener("click", () => {
      const courseCode = document.getElementById("CourseCode").value;
      const courseTitle = document.getElementById("CourseTitle").value;
      const submittedToName = document.getElementById("SubmittedToName").value;
      const submittedToDetails = document.getElementById("SubmittedToDetails").value;
      const submittedByName = document.getElementById("SubmittedByName").value;
      const submittedByDetails = document.getElementById("SubmittedByDetails").value;
      const reportType = document.getElementById("reportTypeSelect").value;

      if (!courseCode || !courseTitle || !submittedToName || !submittedToDetails || !submittedByName || !submittedByDetails || !reportType) {
        alert("Please fill in all fields.");
        return;
      }

      previewContainer.innerHTML = ""; // clear previous preview
      previewContainer.classList.remove("hidden");

      const logo = new Image();
      logo.src = "image.png";
      logo.className = "w-24 h-24 mx-auto";

      previewContainer.appendChild(logo);
      previewContainer.innerHTML += `
        <h2 class="text-xl font-bold">${window.headline1}</h2>
        <h3 class="text-lg">${window.headline2}</h3>

        <p><strong>Course Code:</strong> ${courseCode}</p>
        <p><strong>Course Title:</strong> ${courseTitle}</p>
        <p class="font-bold mt-4">${reportType}</p>

        <div class="mt-4">
          <p class="font-semibold">Submitted to:</p>
          <p>${submittedToName}</p>
          <p>${submittedToDetails}</p>
        </div>

        <div class="mt-4">
          <p class="font-semibold">Submitted by:</p>
          <p>${submittedByName}</p>
          <p>${submittedByDetails}</p>
        </div>
      `;

      // Uncomment this later when you want to enable download
      /*
      html2pdf().from(previewContainer).set({
        margin: 10,
        filename: `${courseCode}_${reportType.replace(/\s+/g, '_')}_Cover.pdf`,
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
      }).save();
      */
    });
  });
</script>
